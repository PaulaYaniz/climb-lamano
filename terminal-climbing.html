<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LA MANO - Terminal Climbing</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            color: #0f0;
            font-family: 'Courier New', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            overflow: hidden;
        }

        #terminal {
            border: 3px solid #0f0;
            padding: 0;
            max-width: 1200px;
            width: 100%;
            background: #001100;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
            position: relative;
        }

        #game-container {
            position: relative;
            width: 100%;
            height: 700px;
            background-image: url('../lamano-drawing.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            border: 3px solid #0f0;
        }

        #game-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        #header {
            text-align: center;
            padding: 10px;
            border-bottom: 2px solid #0f0;
            background: #001100;
        }

        #stats {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            background: rgba(0, 17, 0, 0.9);
            border: 2px solid #0f0;
            padding: 10px;
            z-index: 100;
            font-size: 14px;
        }

        #controls {
            background: #001100;
            border-top: 2px solid #0f0;
            padding: 10px;
            font-size: 12px;
        }

        .blink {
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .highlight {
            color: #ff0;
            font-weight: bold;
        }

        .player {
            color: #0ff;
            font-weight: bold;
        }

        .hold {
            color: #f80;
            font-weight: bold;
        }

        .goal {
            color: #ff0;
            font-weight: bold;
            animation: blink 0.5s infinite;
        }

        #message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ff0;
            text-align: center;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border: 3px solid #0f0;
            z-index: 200;
            min-width: 400px;
            display: none;
        }

        #message.show {
            display: block;
        }
    </style>
</head>
<body>
    <div id="terminal">
        <div id="header">
            <h1>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—</h1>
            <h1>â•‘    LA MANO - TERMINAL CLIMBING v1.0   â•‘</h1>
            <h1>â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</h1>
        </div>

        <div id="game-container">
            <canvas id="game-canvas"></canvas>
            <div id="stats"></div>
            <div id="message"></div>
        </div>

        <div id="controls"></div>
    </div>

    <script>
        class TerminalClimbing {
            constructor() {
                this.canvas = document.getElementById('game-canvas');
                this.ctx = this.canvas.getContext('2d');

                // Set canvas size to match container
                const container = document.getElementById('game-container');
                this.canvas.width = container.clientWidth;
                this.canvas.height = container.clientHeight;

                this.width = this.canvas.width;
                this.height = this.canvas.height;

                // Player position (pixel coordinates)
                this.playerX = this.width / 2;
                this.playerY = this.height - 50;
                this.playerSize = 30;

                this.stamina = 100;
                this.maxStamina = 100;
                this.isGrabbing = false;
                this.score = 0;
                this.time = 0;
                this.gameRunning = true;

                // Generate holds on the hand
                this.holds = [];
                this.generateHolds();

                this.setupControls();
                this.gameLoop();
            }

            generateHolds() {
                // Define finger regions based on the actual hand image proportions
                const fingers = [
                    { name: 'THUMB', x: this.width * 0.2, yTop: this.height * 0.3, yBottom: this.height * 0.8, width: 80 },
                    { name: 'INDEX', x: this.width * 0.35, yTop: this.height * 0.15, yBottom: this.height * 0.8, width: 60 },
                    { name: 'MIDDLE', x: this.width * 0.5, yTop: this.height * 0.05, yBottom: this.height * 0.8, width: 60 },
                    { name: 'RING', x: this.width * 0.65, yTop: this.height * 0.2, yBottom: this.height * 0.8, width: 60 },
                    { name: 'PINKY', x: this.width * 0.8, yTop: this.height * 0.35, yBottom: this.height * 0.8, width: 50 }
                ];

                // Add palm holds
                for (let i = 0; i < 6; i++) {
                    this.holds.push({
                        x: this.width * 0.25 + i * 100,
                        y: this.height - 80,
                        finger: 'PALM',
                        isGoal: false
                    });
                }

                // Add holds on each finger
                fingers.forEach(finger => {
                    const height = finger.yBottom - finger.yTop;
                    const numHolds = Math.floor(height / 60) + 3;

                    for (let i = 0; i < numHolds; i++) {
                        const progress = i / (numHolds - 1);
                        const y = finger.yBottom - progress * height;
                        const x = finger.x + (Math.random() - 0.5) * finger.width * 0.6;

                        this.holds.push({
                            x: x,
                            y: y,
                            finger: finger.name,
                            isGoal: progress > 0.92
                        });
                    }
                });
            }

            setupControls() {
                this.keys = {};

                document.addEventListener('keydown', (e) => {
                    if (!this.gameRunning) {
                        if (e.key === 'r' || e.key === 'R') {
                            location.reload();
                        }
                        return;
                    }

                    this.keys[e.key.toLowerCase()] = true;

                    if (e.key === ' ') {
                        const nearHold = this.getNearestHold();
                        if (nearHold && nearHold.distance <= 50) {
                            this.isGrabbing = true;
                        }
                        e.preventDefault();
                    }
                });

                document.addEventListener('keyup', (e) => {
                    this.keys[e.key.toLowerCase()] = false;

                    if (e.key === ' ') {
                        this.isGrabbing = false;
                    }
                });
            }

            handleMovement() {
                const moveSpeed = 3;
                const climbSpeed = 2;

                // Horizontal movement
                if (this.keys['a'] || this.keys['arrowleft']) {
                    this.playerX = Math.max(this.playerSize, this.playerX - moveSpeed);
                }
                if (this.keys['d'] || this.keys['arrowright']) {
                    this.playerX = Math.min(this.width - this.playerSize, this.playerX + moveSpeed);
                }

                // Vertical movement
                if (this.isGrabbing && (this.keys['w'] || this.keys['arrowup']) && this.stamina > 10) {
                    this.playerY = Math.max(this.playerSize, this.playerY - climbSpeed);
                    this.stamina -= 0.5;
                }
                if (this.keys['s'] || this.keys['arrowdown']) {
                    this.playerY = Math.min(this.height - this.playerSize, this.playerY + 3);
                }
            }

            getNearestHold() {
                let nearest = null;
                let minDist = Infinity;

                this.holds.forEach(hold => {
                    const dx = hold.x - this.playerX;
                    const dy = hold.y - this.playerY;
                    const dist = Math.sqrt(dx * dx + dy * dy);
                    if (dist < minDist) {
                        minDist = dist;
                        nearest = { hold, distance: dist };
                    }
                });

                return nearest;
            }

            update() {
                if (!this.gameRunning) return;

                this.handleMovement();

                // Stamina recovery when not climbing
                if (!this.isGrabbing || this.playerY >= this.height - 100) {
                    this.stamina = Math.min(this.maxStamina, this.stamina + 0.5);
                }

                // Gravity when not grabbing
                if (!this.isGrabbing && this.playerY < this.height - 50) {
                    this.playerY += 2;
                }

                // Keep player in bounds
                this.playerY = Math.max(this.playerSize, Math.min(this.height - this.playerSize, this.playerY));

                // Check for goal
                const nearHold = this.getNearestHold();
                if (nearHold && nearHold.distance <= 30 && nearHold.hold.isGoal) {
                    this.win(nearHold.hold.finger);
                }

                // Check for fall
                if (this.stamina <= 0 && this.playerY >= this.height - 150) {
                    this.gameOver();
                }

                this.time += 1/60;
            }

            render() {
                // Clear canvas
                this.ctx.clearRect(0, 0, this.width, this.height);

                const nearHold = this.getNearestHold();

                // Draw all holds
                this.holds.forEach(hold => {
                    const isNear = nearHold && nearHold.hold === hold && nearHold.distance <= 50;

                    // Draw hold
                    if (hold.isGoal) {
                        // Goal flag - yellow triangle
                        this.ctx.fillStyle = isNear ? '#ffff00' : '#ffd700';
                        this.ctx.beginPath();
                        this.ctx.moveTo(hold.x, hold.y - 15);
                        this.ctx.lineTo(hold.x - 10, hold.y + 5);
                        this.ctx.lineTo(hold.x + 10, hold.y + 5);
                        this.ctx.closePath();
                        this.ctx.fill();
                        this.ctx.strokeStyle = '#ff0';
                        this.ctx.lineWidth = 2;
                        this.ctx.stroke();
                    } else {
                        // Regular hold - circle
                        this.ctx.fillStyle = isNear ? '#ffff00' : '#ff6b00';
                        this.ctx.beginPath();
                        this.ctx.arc(hold.x, hold.y, isNear ? 12 : 10, 0, Math.PI * 2);
                        this.ctx.fill();
                        this.ctx.strokeStyle = '#0f0';
                        this.ctx.lineWidth = isNear ? 3 : 2;
                        this.ctx.stroke();
                    }
                });

                // Draw player
                this.ctx.save();
                this.ctx.translate(this.playerX, this.playerY);

                // Draw climber emoji-style
                this.ctx.font = '40px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.textBaseline = 'middle';
                this.ctx.fillStyle = '#00ffff';
                this.ctx.fillText('ğŸ§—', 0, 0);

                // Draw grab indicator
                if (this.isGrabbing) {
                    this.ctx.strokeStyle = '#0f0';
                    this.ctx.lineWidth = 3;
                    this.ctx.beginPath();
                    this.ctx.arc(0, 0, 25, 0, Math.PI * 2);
                    this.ctx.stroke();
                }

                this.ctx.restore();

                // Update HUD stats
                const height = Math.max(0, Math.floor((this.height - this.playerY) / 10));
                const staminaBar = 'â–ˆ'.repeat(Math.floor(this.stamina / 5)) + 'â–‘'.repeat(20 - Math.floor(this.stamina / 5));

                document.getElementById('stats').innerHTML = `
â”Œâ”€ STATUS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HEIGHT: ${height}m        STAMINA: [${staminaBar}] ${Math.floor(this.stamina)}%  â”‚
â”‚ TIME: ${Math.floor(this.time)}s       GRABBING: ${this.isGrabbing ? '<span class="highlight">YES</span>' : 'NO '}               â”‚
â”‚ CONTROLS: A/D or â†/â†’ = Move  |  W/â†‘ = Climb  |  SPACE = Grabâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`;
            }

            showMessage(msg, show = true) {
                const msgDiv = document.getElementById('message');
                msgDiv.innerHTML = msg;
                if (show) {
                    msgDiv.classList.add('show');
                } else {
                    msgDiv.classList.remove('show');
                }
            }

            win(finger) {
                this.gameRunning = false;
                const stars = this.time < 30 ? 'â­â­â­' : this.time < 60 ? 'â­â­' : 'â­';
                this.showMessage(`
<span class="highlight">
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          ğŸ‰ SUMMIT CONQUERED! ğŸ‰               â•‘
â•‘                                                â•‘
â•‘  Finger: ${finger.padEnd(20)}            â•‘
â•‘  Time: ${Math.floor(this.time)}s ${stars}                           â•‘
â•‘                                                â•‘
â•‘  Press R to climb again                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</span>`);
            }

            gameOver() {
                this.gameRunning = false;
                this.showMessage(`
<span style="color: #f00;">
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          STAMINA DEPLETED - YOU FELL!          â•‘
â•‘                                                â•‘
â•‘  Press R to try again                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</span>`);
            }

            gameLoop() {
                this.update();
                this.render();
                requestAnimationFrame(() => this.gameLoop());
            }
        }

        // Start game
        const game = new TerminalClimbing();

        // Show controls
        document.getElementById('controls').innerHTML = `
â”Œâ”€ CONTROLS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ A / â†  : Move left          D / â†’ : Move right              â”‚
â”‚ W / â†‘  : Climb up (when grabbed)   S / â†“ : Descend         â”‚
â”‚ SPACE  : Grab hold (nearby holds glow yellow!)              â”‚
â”‚                                                              â”‚
â”‚ GOAL: Reach any yellow triangle flag at the fingertips!    â”‚
â”‚ TIP: Rest at holds (grab without climbing) to recover!     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`;
    </script>
</body>
</html>
